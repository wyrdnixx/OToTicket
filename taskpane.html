<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Mail2Ticket - Autocomplete</title>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <style>
    /* ... (Ihr bestehendes CSS) ... */
    .suggestions { border: 1px solid #ccc; max-height: 150px; overflow-y: auto; background: #fff; position: absolute; z-index:1000; }
    .suggestion-item { padding: 6px; cursor: pointer; }
    .suggestion-item:hover { background: #f0f0f0; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Mail2Ticket EWS</h2>
    <div id="status" class="status">Lade Office.js...</div>
    <div id="notifications"></div>

    <div class="form-group" style="position: relative;">
      <label class="form-label">Ticket (4 Ziffern)</label>
      <input type="text" id="ticket" class="form-input" maxlength="4" pattern="[0-9]*" autocomplete="off"/>
      <div id="suggestions" class="suggestions" style="display: none;"></div>
    </div>

    <!-- ... (restlicher Inhalt bleibt unverändert) ... -->
  </div>

  <script>
    let debugMode = false;
    let officeReady = false;
    // ... (bestehende Add-in-Initialisierung, Debug, Notify, usw.) ...

    // --- Autocomplete-Implementierung ---
    const ticketInput = document.getElementById('ticket');
    const suggestionsBox = document.getElementById('suggestions');

    ticketInput.addEventListener('input', async () => {
      const val = ticketInput.value.trim();
      if (val.length >= 2) {
        try {
          const resp = await fetch(`https://your-server.example.com/api/tickets/suggestions?q=${encodeURIComponent(val)}`);
          if (!resp.ok) throw new Error(resp.statusText);
          const list = await resp.json();
          showSuggestions(list.map(t => t.nummer));
        } catch (e) {
          debugLog('Autocomplete-Fehler: ' + e.message);
          suggestionsBox.style.display = 'none';
        }
      } else {
        suggestionsBox.style.display = 'none';
      }
    });

    function showSuggestions(items) {
      suggestionsBox.innerHTML = '';
      if (items.length === 0) { suggestionsBox.style.display = 'none'; return; }
      items.forEach(item => {
        const div = document.createElement('div');
        div.className = 'suggestion-item';
        div.textContent = item;
        div.onclick = () => {
          ticketInput.value = item;
          suggestionsBox.style.display = 'none';
        };
        suggestionsBox.appendChild(div);
      });
      suggestionsBox.style.display = 'block';
    }

    document.addEventListener('click', e => {
      if (!ticketInput.contains(e.target) && !suggestionsBox.contains(e.target)) {
        suggestionsBox.style.display = 'none';
      }
    });

    // --- Rest Ihres Skripts bleibt unverändert (z.B. copyEmail, EWS …) ---

    // Zum Beispiel: Funktion initializeAddin(), loadEmailData(), copyEmail() etc.
  </script>
</body>
</html>
